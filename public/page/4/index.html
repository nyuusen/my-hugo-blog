<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
	<meta name="generator" content="Hugo 0.147.8"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>My New Hugo Site</title>

<meta name="description" content="">
<meta name="author" content="nyuusen">
<link rel="canonical" href="http://localhost:1313/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/index.xml">
<link rel="alternate" hreflang="en" href="http://localhost:1313/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/">
  <meta property="og:site_name" content="My New Hugo Site">
  <meta property="og:title" content="My New Hugo Site">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="My New Hugo Site">
<meta name="twitter:description" content="">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "My New Hugo Site",
  "url": "http://localhost:1313/",
  "description": "",
  "logo": "http://localhost:1313/favicon.ico",
  "sameAs": [
      
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="My New Hugo Site (Alt + H)">My New Hugo Site</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main"> 

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">VPCピアリング
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>VPCピアリングとは？ プライベート IPv4 アドレスまたは IPv6 アドレスを使用して 2 つの VPC 間でトラフィックをルーティングすることを可能にするネットワーク接続です。 どちらの VPC のインスタンスも、同じネットワーク内に存在しているかのように、相互に通信できます。
VPC ピア機能とは - Amazon Virtual Private Cloud
料金 接続の確立には料金かからない AZ内での接続でのデータ通信も料金かからない ただし、異なるAZやリージョン間でのデータ通信には料金が発生する VPC ピア機能とは - Amazon Virtual Private Cloud VPCピアリング接続の構築手順 詳細はVPC ピアリングのプロセス、ライフサイクル、制限 - Amazon Virtual Private Cloudに記載されている。
アカウントAのVPCからアカウントBにVPCに接続する前提だと、ざっくりと以下の流れ。
アカウントAでVPCピアリングを作成 この時に接続先としてアカウントBのVPCを選択する 作成したら「承諾の保留中」というステータスになる アカウントAのVPCはリクエスタという扱いになる アカウントBで該当のピアリング接続を選択し「リクエストを承諾」を選択する アカウントAの対象VPCのルートテーブルを更新する ターゲットには「ピアリング接続」を選択し、送信先には接続先VPCのCIDRを指定する アカウントBの対象VPCのルートテーブルを更新する アカウントAでの設定の逆を設定する VPC ピアリング接続のルートテーブルを更新する - Amazon Virtual Private Cloud アカウントBで対象リソースのセキュリティグループを変更する アカウントA側のリソースにアタッチしているセキュリティグループorアカウントAのVPCのCIDR 前者の方が狭く絞れる分、セキュリティ性は高い ちなみに、両方のVPCが同じリージョンにある場合のみ、相手のVPCのセキュリティグループを参照できる アカウントAのVPCのリソースから、アカウントBのリソースへ接続する ルートテーブルに従って、ピアリング接続で接続できる 注意点 複数のVPCピアリング接続はできない(必ず1対1である必要がある/参考) プライベートIPで名前解決を行うので、それぞれのVPCでCIDRが重複してはいけない(参考) 役立つシーン VPC跨ぎのデータ取得や移行など </p>
  </div>
  <footer class="entry-footer"><span title='2024-12-04 19:30:17 +0900 JST'>December 4, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to VPCピアリング" href="http://localhost:1313/posts/vpc-peering/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">プレフィックスリスト
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>プレフィックスリストとは？ 複数のIPアドレス範囲をまとめて管理できる AWSが提供する「AWSマネージドプレフィックスリスト」と、ユーザー側が作成する「カスタマーマネージドプレフィックスリスト」が存在する 作成されたリージョンのみで利用可能 セキュリティグループ等でIPアドレス単位で設定をする際に有用 IPアドレスリストを手動で管理する際のオーバーヘッド発生を防ぐ AWS側が提供するIPアドレス情報に依存することで、設定ミス等を防ぐこともでき、セキュリティ的にも良い AWSが自動作成するプレフィックスリスト S3 VPCエンドポイント(ゲートウェイ型) Dynamo DB VPCエンドポイント(ゲートウェイ型) EC2 Instance Connect VPC Lattice ※よく見かけるものを抜粋 実際にどのような場面で役立つか？ 同じ内容を持つ複数のセキュリティグループを作成したい場合 例えば、 セキュリティグループを用いてインバウンドルールの送信元IPアドレスを制御したい 同様の内容を制御するセキュリティグループをいくつか作成したい 各セキュリティグループにIPアドレスを手打ちしていくのは手間がかかる＋設定ミスの恐れがある プレフィックスリストを使用することで、IPアドレスの設定を1箇所にまとめることができ、複数のセキュリティグループからそれを参照させることができる S3のVPCエンドポイント(ゲートウェイ型)を利用する時 接続元の方のルートテーブルに自動で生成される 以下のような内容 ターゲット: vpce-xxxxx 送信先: pl-xxxx(自動生成されたプレフィックスリスト) 参考 AWS マネージドプレフィックスリスト - Amazon Virtual Private Cloud </p>
  </div>
  <footer class="entry-footer"><span title='2024-12-02 11:36:10 +0900 JST'>December 2, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to プレフィックスリスト" href="http://localhost:1313/posts/prefix-list/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">KMS
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>KMSとは 暗号化キーの作成と管理機能を提供するマネージドサービス AWS Key Management Service - AWS Key Management Service KMSの必要性 データの暗号化に必要な暗号化キーを保護する必要がある キーの作成・管理・使用・削除がAWS KMS内でのみで行われるので、安全性が高い 自前でこの辺りやるのは大変だけど、KMSで楽に安全にできるよということ KMSの料金 作成したキーに対して、1USD/月 ローテーションすると2回目までは1USD/月 APIリクエストあたり0.0x$ 料金 - AWS Key Management Service | AWS エイリアス 自動で生成される識別子は判別しづらいので、エイリアスを付与することで判別しやすくなる エイリアスを使用することで、キーをノーテーションしてもアプリケーション側での変更が不要 KMSのポリシー KMS側にはキーポリシーがある キーポリシーでは暗号キーに対して、どのリソースに対して何をできるかを定義することで、特定のサービスからのみアクセスさせるという制御が可能 例えば、ECSタスクに割り当てるロールに、特定のKMSに対する暗号復号のアクションを許可するみたいなことができる </p>
  </div>
  <footer class="entry-footer"><span title='2024-11-29 21:55:12 +0900 JST'>November 29, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to KMS" href="http://localhost:1313/posts/kms/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">AWS Certificate Manager
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>ACMとリージョンの関係 ACM証明書はリージョナルリソースであるため、作成する際に適用するリソースに合わせ、リージョンを意識する必要がある。
CloudFront グローバルサービスなので、米国東部 (バージニア北部, us-east-1) リージョンに作成する ALB リージョンサービスなので、ALBが配置されているリージョンに作成する 通信が暗号化する流れ(おさらい) サーバー側に証明書と秘密鍵をインストールする(証明書発行前の手続き等は省略) これを担うのがACM証明書 クライアントからのHTTPS通信に対し、証明書を返却する クライアント側でCAやドメインの検証が行われる クライアントからの通信が公開鍵で暗号化される サーバー側で保持している秘密鍵で通信を復号する この辺り(というか証明書発行・認証周りを)を抽象化、マネージドに提供してくれているのがACMとなる
ACMの認証について ACMに限らない話だが、証明書を発行する際に、証明書を発行した者が問題ないか？ドメインに対する権限を持っているか？等を検証する必要がある この確認がないと、好き勝手に証明書作り放題になる ここを実施しているのがCA(認証局) その検証の部分を「認証」と呼ぶ 認証には、DV・OV・EV認証という種類がある 参考: DV、OV、EV の各 SSL 証明書の違いとは | DigiCert 右に行くほど厳格な認証方法となる ACMはDV認証(ドメイン認証＝該当ドメインに対する権限を保持しているかどうかのみを確認する) ACMはDV認証をどうやっているのか？という話になるが、以下の手順で確認する ACM証明書を発行すると、CNAME名とCNAME値が発行される(この段階ではACM証明書は未承認状態) 該当ドメインのホストゾーンにCNAME名とCNAME値をCNAMEレコードとして登録する ACM証明書が認証状態になる 🎉 </p>
  </div>
  <footer class="entry-footer"><span title='2024-11-27 22:55:34 +0900 JST'>November 27, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to AWS Certificate Manager" href="http://localhost:1313/posts/acm/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">WebアプリケーションをECSからLambdaに移行する
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>参考資料 https://speakerdeck.com/fujiwara3/yapc-hakodate2024
要約 元はECSで動いていたWebアプリケーションだが、負荷予測を外した時に障害もしくはインフラコスト過剰にかかる課題があった AWS Lambda Web Adapterを使って、Lambdaで Webアプリケーションを動かす 結果として、実際の負荷に応じてスケーリングしてくれて課題が解消された 感想 Lambdaはシンプルな関数を配置するイメージがあったが、Adapterを使うことでWebアプリケーションも配置できることを知れた Lambdaであれば、実行時間等の制約があるものの、実際に負荷に応じたスケーリングをしてくれるのがとても良いなと思った 最後のスライドでも言及されているが、向き不向きもある。アーキテクチャ選定の選択肢の1つとして頭に入れておきたい </p>
  </div>
  <footer class="entry-footer"><span title='2024-11-06 18:18:40 +0900 JST'>November 6, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to WebアプリケーションをECSからLambdaに移行する" href="http://localhost:1313/posts/ecs-migrate-to-lambda/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Dependabot
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>Dependabotとは？ GitHubによって提供される、プロジェクトの依存関係を自動的に管理・更新するツール 依存関係の脆弱性アップデートを通知してくれたり、自動的に提案するプルリクエストを作成してくれたりする 詳細は：Dependabotとは 使い方 GitHubリポジトリの設定から有効化できる Security &gt; Code security and analysis .github/dependabot.ymlにチェック頻度や対象範囲を定義できる Dependabot を使う - GitHub Docs GitHubActionsワークフローを用いて効率的に運用する 例えば、 プルリクエスト作成時に自動でテスト実行する等のワークフローを組み込んでおく dependabot/fetch-metadata アクションを用いてアップデート情報を取得する 取得した結果をPRにコメントとしてぶら下げるみたいなこともできそう ただし、プルリクエストは人間の目で見て、マージすることが推奨されている(そりゃそう) GitHub ActionsでのDependabotの自動化 - GitHub Docs 注意点 Docker DependabotにはDockerfileのベースイメージ(FROMフィールド)に記述されたバージョンアップの対象とすることができるが、
DockerComposeファイル(compose.yaml)に記述されたイメージ指定(imageフィールド)を対象とすることは現状できない。
対策としては、DockerComposeにイメージをベタ書きせずにDockerfileに切り出すとかRenovateにするかとか…
参考：Docker Compose files対応が待ち望まれているIssue
</p>
  </div>
  <footer class="entry-footer"><span title='2024-10-30 23:36:19 +0900 JST'>October 30, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to Dependabot" href="http://localhost:1313/posts/dependabot/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">AWSにおけるコスト削減対応
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>はじめに 業務や参加した勉強会でコスト削減についての学びがあったのでメモ
勉強会URL: https://www.youtube.com/live/WOsD-Rk3SVg?si=El_AK4863iGt8L42
大前提としての心構え コスト削減対応で浮いた分は単純な利益増につながる つまり後回しにせず、早くやろうぜという気持ちで やり方 モブでやってあーだこーだ言ってみる 職能を絞らないでやるのも視野が広がって良いアイディアが生まれたりする 具体的なコストカットポイント NATゲートウェイ→VPC Endpoint やはりNATゲートウェイは高い！ ECRからのイメージプルをECR pull through cacheでキャッシュ化 コンテナイメージのサイズダウン 各インスタンスのサイジングやスペック見直し テスト環境のサーバーを夜間休日は停止する 例: Amazon EventBridge Schedulerで平日夜間になったらECSのタスク数を0にする リザーブドインスタンスやSavingsPlansの活用 </p>
  </div>
  <footer class="entry-footer"><span title='2024-10-28 22:57:29 +0900 JST'>October 28, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to AWSにおけるコスト削減対応" href="http://localhost:1313/posts/cost-reduction/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">IPv4 VPC CIDRブロック
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>概要 VPCを作成するときに、そのVPCのIPv4 CIDRブロックを指定する必要がある。
許可されるブロックは、/16ネットマスク（65,536個のIPアドレス）から/28ネットマスク（16個のIPアドレス）になる。
CIDRブロックについて簡単に整理 /数字の数字に当たる部分がネットワークアドレスとして固定化される IPアドレスは32ビットで表現される例えば/16の場合は、前半16ビットがネットワーク部・後半16ビットがホスト部になる 従来のクラスに縛られない効率的なIPアドレス管理を目的とした方法 プライベートIPアドレスに指定する範囲 以下で設定されることが推奨されている 10.0.0.0/8 – 範囲：10.0.0.0 ～ 10.255.255.255 172.16.0.0/12 – 範囲：172.16.0.0 ～ 172.31.255.255 192.168.0.0/16 – 範囲：192.168.0.0 ～ 192.168.255.255 これはRFC1918で指定されているもの ネットワーク部が固定数値である理由 例えば、/8(10.0.0.0/8)の場合の第1オクテッドがなぜ「10」であるのかが気になった。
結論：インターネット上の実際のパブリックIPアドレスと競合を防ぐため RFC1918で定義された範囲以外のIPアドレスをプライベートネットワークで使用すると、インターネット上のパブリックIPアドレスと競合する可能性がある そのため、インターネット上でユニークであることが保証されないプライベートネットワークでは、RFC1918で指定された「10.0.0.0/8」「172.16.0.0/12」「192.168.0.0/16」の範囲のみが使用されることが推奨されている RFC1918定義外のCIDRブロックは指定できるのか？ それを検証している面白い記事を発見 RFC 1918定義外のIPアドレスをVPCのCIDRブロックに指定してみた | DevelopersIO 設定はできるが、ALBターゲットに設定できなかったりと、色々な不具合があるらしい 参考 VPC CIDR ブロック - Amazon Virtual Private Cloud
</p>
  </div>
  <footer class="entry-footer"><span title='2024-10-28 22:57:29 +0900 JST'>October 28, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to IPv4 VPC CIDRブロック" href="http://localhost:1313/posts/vpc-ipv4-cidr-block/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">DNS
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>名前解決の流れ クライアントがドメイン(example.com)へのアクセスを試行する クライアントが設定されたDNSリゾルバにドメイン名を問い合わせを行う DNSリゾルバがルートネームサーバ(.com)にネームサーバー(NS)情報を取得する DNSリゾルバがセカンドレベルドメイン(example.com)からIPアドレスを取得する DNSリゾルバがクライアントにIPアドレスを返す クライアントが名前解決されたドメインにアクセスする 参考: 新入社員「DNSってなんですか？」→ これ、どこまで答えられますか？？？？？？？？？ ドメイン移管の流れ 業務でAWSアカウントを跨いだドメイン移管を行ったので、流れをまとめておく。
AWSのRoute53を用いてドメイン管理を行なっているものとする。
移管先に対象ドメインのホストゾーンを作成(NSレコードが生成される) 親ドメインを管理しているホストゾーンの対象ドメインのNSレコードを更新する 注意ポイント 対象ドメインの向き先(Aレコード)はCloudFrontディストリビューション(CFD)であったが、代替ドメイン名(CNAMEs)はユニークである必要があった そのため、旧アカウントと新アカウントのそれぞれのCFDの代替ドメイン名に今回のドメインを同時に設定しておくことができなかった 以下の公式で紹介されている通り、ワイルドカードを使用する方法を採用したかったが、親ドメインの管理権限が自分たちになかったため、仕方なしに、旧の代替ドメイン名を一旦空にしてから、新の代替ドメイン名を設定するようにした。 代替ドメイン名を別のディストリビューションに移動する - Amazon CloudFront この方法では、一時的に証明書エラー(HTTPS接続エラー)が発生することに注意は必要 ちなみにこの代替ドメイン名は、ACM証明書の認証に使用されているらしい ACM認証用CNAMEレコードを登録するゾーンについて ACMで発行した証明書のDV認証にはCNAMEレコードの登録が必要になる。
その際に、Route53のどのホストゾーン(親？子？)にCNAMEレコードを登録すべきかという件について、ちょっと調べた。
結論：移譲されている子のホストゾーンに登録する ちなみに移譲元である親のホストゾーンに登録しても認証は通らない(digコマンドとかでCNAMEレコードの名前解決がそもそもできない) そもそもDV認証というのは「該当ドメインの所有者であるか？」の確認するための目的で、ACM証明書作成時に発行されるCNAMEレコードをそのドメインに登録させるという手段を取っている そしてこの認証が対象ドメインのDNSゾーンに対して行われるため、権限を移譲してしまっている親ドメインでは認証が通らないためと思われる 対象ドメイン名のネームサーバーを問い合わせる→指定されたCNAMEレコードがそのドメインのDNSに存在するかを定期的に確認している 結局、AレコードやCNAMEレコード等のレコード種別に関係なく、ネームサーバーを辿っていき、対象ドメインのDNSゾーンの何らかのレコードを解決するという方法になる そもそもDNSゾーンとは？ あるドメインに関連するDNSレコードを管理するための領域(namespace) </p>
  </div>
  <footer class="entry-footer"><span title='2024-10-24 22:57:11 +0900 JST'>October 24, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to DNS" href="http://localhost:1313/posts/dns/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">HTTPS
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>SSL証明書の種類 ドメイン認証(DV) CAが申請者がドメイン管理者であることのみを確認する ACMでのCNAMEレコードを用いた認証はこれに該当する 組織認証(OV) CAは合法的な存在であることを確認する 拡張検証(EV) CAは厳格な検証プロセスを通じて組織を確認する ブラウザのアドレスバーが緑色になる </p>
  </div>
  <footer class="entry-footer"><span title='2024-10-23 23:12:52 +0900 JST'>October 23, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to HTTPS" href="http://localhost:1313/posts/https/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ubuntu server(EC2)のデフォルトシェルをdashからbashに変更する
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>変更方法 以下の**設定変更可能なシェルのプロファイルを有効化する(コンソール)**の方法で変更できた。
https://repost.aws/ja/knowledge-center/ssm-session-manager-change-shell </p>
  </div>
  <footer class="entry-footer"><span title='2024-10-07 22:09:49 +0900 JST'>October 7, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to ubuntu server(EC2)のデフォルトシェルをdashからbashに変更する" href="http://localhost:1313/posts/ubuntu-dash-to-bash/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">LambdaのログをS3に保存する.md
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>概要 Webhookを受け付けるAWS Lambda関数で出力するログをS3に保存(転送)したい
目的と要件 ログを永続化し、簡易分析したい 分析時はなるべく手をかけずにログを取得したい 実装工数をあまりかけたくない(一時的に必要な機能であるため) コストを安く抑えたい 実現方法 CloudWatch LogsからS3にエクスポート AWSマネージドコンソールのCloudWatch　Logsのアクションメニューからログデータのエクスポートを選択する 対象日時等でフィルターをかけた上で指定するS3バケットにログファイルを出力する フィルター条件や対象範囲にカスタマイズ性を持たせたい場合は有効そう CloudWatch LogsからS3にエクスポート(自動実行) 上記の一連の流れをEventBridge Schedulerで自動実行させる 手順がとても簡単そう CloudWatch LogsをS3に転送するためにEventBridge Schedulerを使用する 今回の安く簡単にという要件に最もマッチしそう Lambda関数からリアルタイムにログをS3に転送 Lambda関数の処理の中でログの出力先(保存先)をS3に保存する プログラム内でAWS SDKを使ってPutObjectメソッドを実行するイメージ Lambdaでリクエストを受け付ける度にS3アクセスが発生するため、レイテンシが懸念になる ログ毎にファイル生成するのでは検索性が悪いので、1つのファイルに蓄積させる方法は(？) ちょっと調べたが、GetObjectした後に更新したコンテントを新たにPutObjectするしかなさそう..？ S3はオブジェクトストレージなので、ファイルに追記とかはできなそう Lambdaのみで処理が完結するのはメリット(?)ではあるが、上記の懸念があるためあまり有効な選択肢にはならなそう その他 CloudWatchLogsのサブスクリプションフィルターにて、KinesisDataFirehoseを指定し、KinesisDataFirehose側ではターゲットとなるS3を指定するKinesis Data Firehoseを使用してログをストリームさせる方法もあるっぽい 参考 CloudWatchLogsのログをS3に転送する方法の比較 #AWS - Qiita
</p>
  </div>
  <footer class="entry-footer"><span title='2024-10-04 22:32:31 +0900 JST'>October 4, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to LambdaのログをS3に保存する.md" href="http://localhost:1313/posts/transfer-log-to-s3/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Language Server Protocol(LSP)
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>はじめに 職場の方が語っていたので興味本位で調べてみる。
Language Server Protocol(LSP)とは？ テキストエディタやIDE（統合開発環境）とプログラミング言語のサーバー（言語サーバー）との間で通信を行うためのプロトコルのこと コード補完やシンタックスハイライト等の機能提供してくれる Microsoftが提唱した LSPの必要性 エディタに関係なく一貫した開発体験を得られる 言語ごとに専用のプラグインやサポートを作成するのは手間がかかる 技術的な構成 エディタやIDEと言語サーバーがLSPを通じて通信する 言語サーバー 実体はプログラミング言語環境 VSCodeではGoという拡張機能をインストールするとgoplsというGoの言語サーバーがローカルにインストールされるっぽい(?) VSCode &#43; Goだと..？ Goの言語サーバーの実装がgoplsである VSCodeのsettings.jsonの&#34;go.useLanguageServer&#34;: trueでLSP設定をONにできる </p>
  </div>
  <footer class="entry-footer"><span title='2024-10-04 22:32:31 +0900 JST'>October 4, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to Language Server Protocol(LSP)" href="http://localhost:1313/posts/lsp/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">NewRelic
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>はじめに 業務でNewRelicを使用しているが基礎的な部分も含めてあまりわかっていないので調べる
進め方 とりあえずNewRelicドキュメントを眺める
New Relic Documentation
NewRelicを使い始める New Relicを使い始める | New Relic Documentation 用語の定義 NewRelic One: 管理画面 テレメトリデータ：パフォーマンスデータ 機能群 アラート アプリケーション異常発生時にSlack等に通知する APM アプリケーションパフォーマンス監視のこと アプリケーションにエージェントを導入し、NewRelicデータベースに保存する 様々な種類のデータを収集・監視できる ブラウザ ウェブサイトのパフォーマンスを監視する 具体的には、ページロードタイムやJavaScriptエラー、ユーザーインタラクションの追跡 ブラウザ側でのユーザーアクションやランタイムエラー、性能が監視できるという理解 ダッシュボード 運用者側でデータを好きなように整理できる エラーインボックス エラー追跡ソリューション あまりわかっていないが、エラーの種類ごとにエラーカウントを出してくれたりする？ インフラストラクチャモニタリング コンテナ等のクラウドインフラのCPUやメモリ、ネットワークトラフィック、ディスク使用量をカバーする ログ ログプロバイダーからログを転送する OpenTelemetry アプリケーションやホストからデータを収集し、NewRelicに送信する データのクエリ NRQL(NewRelicクエリ言語)で詳細な条件でデータを収できる SQLに似ている サービスレベル アプリケーションのサービスレベル指標(SLI)と目標(SLO)を設定して測定できる 合成のモニタリング(Synthetics) 外形監視機能 ユーザーがフロントエンドのアプリやサービスをどのように使用するかをシュミレートできる 脆弱性管理(Vulnerability) ソフトウェアの脆弱性を管理する チュートリアル アラートの作成と管理 Incidents: 条件閾値に違反するイベント Issues: 通知の送信の原因となる1つ以上のインシデントの集合 この2つの違いがあまりわからない アラートを管理するためには、 通知方法をPoliciesとして設定する 通知条件をConditionsとして設定する 例えば、ALBが5xx系のエラーが全体の80%を超えたら、設定済みPoliciesにある「SLack通知する」みたいな条件を作っていく 条件自体は、NRQLでクエリを書く形になる どのようにNewRelicを活用するか どのようにデータを転送するか NewRelicを見る時のポイント</p>
  </div>
  <footer class="entry-footer"><span title='2024-10-04 22:32:31 +0900 JST'>October 4, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to NewRelic" href="http://localhost:1313/posts/newrelic/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">UUIDやULID
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>概要 データベース設計において、AutoIncrementな純粋な番号(連番)の他にUUIDやULIDがあるけど、それらの違いと結局どれ使えば良いのかという話。
連番の欠点 まず最初に脳死で設計する時に選択肢となる連番の欠点について理解してみる。
リソースの特定の容易になる システム規模(会員数)が推測されやすい この辺りが挙げられる。セキュリティ面(悪意あるユーザーに攻撃される)以外においても、競合他社から容易にシステムのことを推測されやすくなり、優位にビジネスを進められてしまうみたいなこともあるかもしれない。
UUID UUIDとは何か？特徴を列挙する。
Universally Unique Identifier 128bit 複数のバージョンが存在する v4: 全てのビットをランダム値にする（生成が簡単で、一意性が高い） 128ビットのうち、特定の4ビット（バージョンフィールド）を0100に設定する 次に、特定の2ビット（バリアントフィールド）を10に設定する（これにより、UUIDがRFC 4122に準拠していることを示す） v7: v4をソート可能にしたもの 現在のタイムスタンプをミリ秒単位で取得し、48ビットのビット列に変換する 残りの80ビットを暗号学的に安全な乱数で埋める ULID 続いて、ULIDとは何か？特徴を列挙する。
Universally Unique Lexicographically Sortable Identifier UUIDの欠点を補う形で設計された一意識別子 時系列順にソート可能で、データの管理や検索が容易 UUIDと比べて短く、URLなどで使用する際に便利 生成方法 タイムスタンプの取得：現在のタイムスタンプをミリ秒単位で取得し、48ビットのビット列に変換 残りの80ビットをランダムな値で埋める 生成されたビット列をCrockford’s Base32でエンコード UUID v7とULIDの違い UUID v7とULIDの違いをまとめる。基本的にはULIDの方が優れているように感じる。
文字数 UUIDv7：ハイフンを含む36字 ULID：特殊文字を含まない26文字 ランダム部 UUIDv7：12bit &#43; 62bit ULID：80bit 特殊文字の使用 UUIDv7：ハイフンを含む ULID：特殊文字を含まない） UUIDやULIDの欠点 連番より優れていそうなUUIDやULIDだが、以下のような欠点もある。
インデックスには不都合があり、クエリパフォーマンスが低下する UUID v4はソートができない UUID v7とULIDは生成時間が漏洩するリスクがある クエリパフォーマンスが低下するについて深堀りする 「インデックスには不都合があり、クエリパフォーマンスが低下する」というだけでは納得できないので、ちょっと深堀りしてみる。
MySQL(InnoDB)の話になるが、主キーのインデックスとしてクラスタインデックスがある。
これはキーの値を比較した順序が近いほど物理的に近接した場所にレコードのデータが配置されるため、連番の場合は、連続して投入されたデータはディスク上に近い場所にあり、キャッシュの恩恵が受けられる。
UUID(v4)は、書き込み先がランダムになるので、キャッシュヒットの割合が下がり、パフォーマンスが低下する。
一方、UUID v7やULIDは先頭48bitがタイムスタンプであり、クラスタインデックス上でも投入順に隣接して格納される。
PostgreSQLは、主キーインデックスとは別の領域にレコードデータが保存されるため、このような制約がない。何なら標準でUUID型も用意されている。
結論 結論としては、その時のケースによって使い分ければ良いのかなと思う。
完全な個人的な意見ではあるが、ユーザーに露出するデータはUUID v7 or ULIDにして、それ以外は連番で良いのかなと思った。
UUID v4はあえて使うシーンはなさそうかなという印象。
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-10-04 22:32:31 +0900 JST'>October 4, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to UUIDやULID" href="http://localhost:1313/posts/uuid-ulid/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">システムリプレイス
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>はじめに あるtoCサービスのリプレイスの話
システム構成 フロントエンド: HTML/JavaScript S3に静的ホスティング バックエンド: TypeScript/Fastify ECS on Fargate データベース: RDS キャッシュ: CloudFront Firewall: AWS WAF リプレイスの概要 現在稼働しているシステムの運用会社の変更に伴うリプレイス AWSアカウント自体も変更になる サービス自体は、別の外部サービスへの送客するだけの小さいサービス 進め方 (事前)新環境の開発&amp;デプロイ 非公開状態 現環境をメンテナンスモード 誤って旧環境でデータ作成等が行われないようにする 現環境→新環境にデータ移行 事前にデータ移行用のバッチを作成 新環境の動作が問題ないかをテスト 社内ネットワークのみに公開する 新環境のIP制限を解除し、外部に公開 勉強になったポイント データ移行バッチで扱うデータ量が多く、移行時にAWSマネージドサービスを使用する場合は、スロットリング制限を考慮して実装を行う 今回はAWS KMSを使用して一部データを暗号化していたので、何も考えずに実装したらスロットリング制限に引っかかってしまった データ移行前に、現環境はメンテナンスモードにする 万が一、データ移行中等に現環境の方にデータが作成されてしまったら、移行対象外となり、障害発生の可能性がある メンテナンスモードに切り替える際にCloud Frontのオリジンを変更する場合は、キャッシュ保持期間に気を付ける キャッシュのInvalidateを行わないと、普通のページにアクセスできてしまう恐れがある (新環境リリース後)現環境メンテナンスモード内に配置するリンク等は新環境のものにしておく オートリダイレクトにするのもあり HTMLならmeta refreshでできる &lt;meta http-equiv=&#34;refresh&#34; content=&#34;リダイレクトするまでの秒数; URL=新URL&#34;&gt; APIなら、HeaderのLocationフィールドに新URLをセットして30x系のリダイレクトのHTTPステータスコードを返す JavaScriptを使用するのも可能だが、SEO的に微妙らしい </p>
  </div>
  <footer class="entry-footer"><span title='2024-10-04 22:32:31 +0900 JST'>October 4, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to システムリプレイス" href="http://localhost:1313/posts/system-replace/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">リダイレクトについて
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>はじめに リダイレクト3xx系のHTTPステータスコードについて調べた。 歴史的背景とかが絡んで、仕様と実態の乖離等が発生し、わかりづらいものになっているらしいので整理。
301 Moved Permanently リクエストされたリソースが完全にHTTPヘッダーのLocationで示されたURLに移動したことを示す ブラウザはこのURLにリダイレクトするが、検索エンジンはリソースへのリンクを更新する 一部の古いクライアントでは、不正にメソッドがGETに書き換えられる恐れがあるので、GETリクエストのみで使用する SEO的には最も優れている？ 参考: 301 Moved Permanently - HTTP | MDN 302 Found リクエストされたリソースが一時的にHTTPヘッダーのLocationで示されたURLに移動したことを示す ブラウザはこのURLにリダイレクトするが、検索エンジンはリソースへのリンクを更新しない 一部の古いクライアントでは、不正にメソッドがGETに書き換えられる恐れがあるので、GETリクエストのみで使用する 参考: 302 Found - HTTP | MDN 303 See Other リダイレクトが新しくアップロードされたリソースではなく、 (確認ページやアップロード進捗ページのような) 別なページにリンクすることを示す PUTやPOSTの結果として送り返される リダイレクト先の表示にはGETを使用する 参考: 303 See Other - HTTP | MDN 307 Temporary Redirect リクエストされたリソースが一時的にHTTPヘッダーのLocationで示されたURLに移動したことを示す リクエストメソッドと本文が変更されないことが保証される 使用されるメソッドをGETに変更したい場合は303を使用する 参考: 307 Temporary Redirect - HTTP | MDN 308 Permanent Redirect リクエストされたリソースが完全にHTTPヘッダーのLocationで示されたURLに移動したことを示す(301と同じ) リクエストメソッドと本文が変更されないことが保証される 参考: 308 Permanent Redirect - HTTP | MDN ステータスコード別のユースケース ではどれを使えば良いのかというのを調べてみる
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-10-04 22:32:31 +0900 JST'>October 4, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to リダイレクトについて" href="http://localhost:1313/posts/redirect/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Environments
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>Environmentsとは GitHubActionsの機能であり、リポジトリに設定できるもの 環境ごとにプロテクションルールや変数、シークレットを保持することができ、環境を指定して、ワークフローを指定することで、必要な権限のみでデプロイを実行できたりする デプロイに環境の使用 - GitHub Docs 使い方 Environmentsの設定自体はGitHubの管理画面のSettingsから設定が可能 ワークフローからはenvironmentフィールドにEnvironmentsの環境名を指定する ユースケース 環境ごとに必要な変数やシークレットを使用する 例えば環境ごとに適切なAWSのロールを設定することで、セキュリティ性を向上させることができる 参考 [GitHub Actions] ブランチごとにジョブの実行を制御できる Environments を試してみた | DevelopersIO </p>
  </div>
  <footer class="entry-footer"><span title='2024-08-16 10:56:56 +0900 JST'>August 16, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to Environments" href="http://localhost:1313/posts/environments/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Makefile
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>Makefileの基本 全てはここに載っている：GNU make GNUというは「グヌー」というらしく、フリーソフトウェア（特に、オープンソースソフトウェア）のみでUNIX風のOSと関連するソフトウェア群を開発・公開するプロジェクト 簡単に内容把握する:Makefileの基本 細かなTips nオプション make -n xxxで実行されるコマンドを表示する（dry-run） .PHONY ターゲットと同名のファイルが実行ディレクトリ以下に存在していた場合、makeコマンドはターゲットに指定されているコマンドを実行しないというのがデフォルト .PHONYにターゲットを書くことで、ファイルの存在有無関係なく、コマンドを実行してくれる もし仮に同名のファイルが作成されてしまったためにmakeコマンドが実行されなくなってしまう等の問題を避けることを目的としている 全てのターゲットは.PHONYに指定するで良さそう shell関数 $(shell echo hoge)とかでシェルを実行する 変数展開 即時展開(:=)と遅延展開(=)の2種類がある（本当はもっとある) 即時展開(:=) 定義の段階で一度だけ即時で評価される 常に結果を固定したい場合や計算コストが高い処理を一度だけ実行し、その値を使い回ししたい場合に使用する 遅延展開(=) 使用される度に右辺を評価される 動的な値が必要な場合に使用する 参考 Makeの変数における代入タイプについて - Howdunnit </p>
  </div>
  <footer class="entry-footer"><span title='2024-08-16 09:13:56 +0900 JST'>August 16, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to Makefile" href="http://localhost:1313/posts/makefile/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">## オブザーバビリティ
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>オブザーバビリティとは 以下の記事が最も腹落ちする説明だった。
https://ymotongpoo.hatenablog.com/entry/2019/03/25/084500
</p>
  </div>
  <footer class="entry-footer"><span title='2024-08-14 09:00:11 +0900 JST'>August 14, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;nyuusen</footer>
  <a class="entry-link" aria-label="post link to ## オブザーバビリティ" href="http://localhost:1313/posts/observerbility/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="http://localhost:1313/page/3/">
      «&nbsp;Prev&nbsp;
    </a>
    <a class="next" href="http://localhost:1313/page/5/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">My New Hugo Site</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
